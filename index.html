<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intellisense AI - Ativo de Guerra: Simulador Operacional Nacional (v5.0)</title>
    
    <!-- M√ìDULO 2: Tipografia Elevada (Manrope/Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- √çcones Vetoriais de Alta Qualidade (Feather Icons) -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

    <style>
        /* ========================================================= */
        /* M√ìDULO 2: REFINAMENTO VISUAL v5.0 - Mobile-First & Luxo   */
        /* ========================================================= */
        :root {
            --color-primary: #0a84ff; 
            --color-danger: #ff453a; 
            --color-success: #34c759; 
            --color-warning: #ff9f0a;
            --color-bg-dark: #121212; 
            --color-bg-gradient-start: #1c1c1e;
            --color-bg-gradient-end: #121212;
            --color-text-light: #f2f2f7;
            --color-card-bg: rgba(44, 44, 46, 0.7 ); 
            --color-card-border: rgba(58, 58, 60, 0.5); 
            --font-family: 'Manrope', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --backdrop-blur: 15px; 
            --swot-quadrant-bg: rgba(68, 68, 70, 0.4); 
            --action-plan-bg: #004587; /* Cor distintiva para o Plano de A√ß√£o */
        }
        body {
            font-family: var(--font-family);
            background: radial-gradient(circle at top left, var(--color-bg-gradient-start) 0%, var(--color-bg-gradient-end) 100%); 
            color: var(--color-text-light);
            margin: 0;
            padding: 1rem; /* Mobile-First: Padding menor */
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
        }
        
        /* PRIORIDADE 2: Mobile-First Layout (Padr√£o: 1 Coluna) */
        .dashboard {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            display: grid;
            gap: 1.5rem; /* Menor gap para mobile */
            grid-template-columns: 1fr; /* Coluna √∫nica por padr√£o */
            opacity: 0; 
            transform: translateY(20px); 
            animation: fadeInSlideUp 0.8s ease-out forwards;
        }
        
        /* Garantindo que todos os cart√µes ocupem a largura total em mobile */
        .header, .cost-calculator, .heatmap, .ticket-simulator-wrapper { 
            grid-column: 1 / -1; 
        }

        .card {
            background-color: var(--color-card-bg);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--color-card-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(var(--backdrop-blur));
            -webkit-backdrop-filter: blur(var(--backdrop-blur));
        }
        
        h1 { font-size: 2rem; color: white; letter-spacing: 0.05em; } /* Fonte menor para mobile */
        h2 { color: var(--color-primary); border-bottom: 1px solid var(--color-card-border); padding-bottom: 0.75rem; margin-bottom: 1rem; font-size: 1.3rem; display: flex; align-items: center;}
        
        /* Calculadora do Custo */
        #revenue-lost {
            font-size: 3rem; /* Menor para mobile */
            color: var(--color-danger);
            font-weight: 700;
            margin: 0.5rem 0;
            animation: pulse 1.5s infinite alternate;
            text-shadow: 0 0 15px var(--color-danger); 
        }
        input[type="range"] {
            width: 100%; margin: 1rem 0;
        }

        /* Mapa de Calor */
        .bar { height: 40px; } /* Maior para toque */
        
        /* Modal SWOT */
        .swot-modal { height: 95vh; padding: 20px; }
        .swot-grid {
            display: grid;
            grid-template-columns: 1fr; /* Padr√£o: 1 coluna para SWOT em mobile */
            gap: 20px;
        }
        .swot-quadrant h3 { font-size: 1.3rem; }
        .swot-quadrant li { 
            list-style: none; /* Remove bullet padr√£o */
            margin-bottom: 15px; 
            padding-left: 0;
        }
        /* PRIORIDADE 1: Estrutura T√≠tulo + Detalhe */
        .swot-quadrant li strong {
            display: block;
            font-size: 1rem;
            color: white;
            margin-bottom: 3px;
        }
        .swot-quadrant li p {
            font-size: 0.9rem;
            margin: 0;
            opacity: 0.7;
            padding-left: 5px; /* Pequeno recuo para o detalhe */
        }

        /* PRIORIDADE 1: Plano de A√ß√£o Recomendado */
        .action-plan-banner {
            margin-top: 30px;
            padding: 20px;
            border-radius: 12px;
            background-color: var(--action-plan-bg);
            border: 1px solid var(--color-primary);
            box-shadow: 0 5px 20px rgba(10, 132, 255, 0.2);
        }
        .action-plan-banner h3 {
            font-size: 1.4rem;
            color: white;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .action-plan-content { display: flex; flex-direction: column; gap: 15px; }
        .action-point { display: flex; gap: 10px; align-items: flex-start; }
        .action-point .step-number {
            background-color: var(--color-success);
            color: var(--color-bg-dark);
            font-weight: 700;
            width: 25px; height: 25px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            font-size: 0.9rem;
        }
        .action-point p { margin: 0; font-size: 1rem; }
        
        /* Tabela de M√©tricas Refinada (Fraquezas) */
        .metric-table th, .metric-table td { padding: 10px; }


        /* ========================================================= */
        /* Media Queries Estrat√©gicas (PRIORIDADE 2)                 */
        /* ========================================================= */

        /* Tablet Layout (min-width: 768px) */
        @media (min-width: 768px) {
            body { padding: 1.5rem; }
            h1 { font-size: 2.2rem; }
            h2 { font-size: 1.4rem; }
            #revenue-lost { font-size: 4rem; }
            
            /* Ativa√ß√£o do Grid (Duas Colunas Principais) */
            .dashboard {
                grid-template-columns: repeat(12, 1fr);
                gap: 2rem;
            }
            .cost-calculator { grid-column: 1 / -1; } /* Continua full width */
            .heatmap { grid-column: 1 / 7; } /* 6/12 - 50% */
            .ticket-simulator-wrapper { grid-column: 7 / -1; } /* 6/12 - 50% */
            
            /* SWOT Grid (2x2) */
            .swot-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 30px;
            }
        }

        /* Desktop Layout (min-width: 1024px) */
        @media (min-width: 1024px) {
            body { padding: 2rem; }
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.5rem; }
            #revenue-lost { font-size: 5rem; }
            .dashboard {
                max-width: 1200px; /* Largura fixa no desktop */
            }

            /* Layout de Grid Completo (v4.0/v3.1) */
            .cost-calculator { grid-column: 1 / -1; }
            .heatmap { grid-column: 1 / 8; } /* 7/12 */
            .ticket-simulator-wrapper { grid-column: 8 / -1; } /* 5/12 */
        }

        /* Anima√ß√µes (mantidas) */
        @keyframes fadeInSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            from { transform: scale(1); text-shadow: 0 0 20px rgba(255, 69, 58, 0.4); }
            to { transform: scale(1.03); text-shadow: 0 0 35px rgba(255, 69, 58, 0.8); }
        }
    </style>
</head>
<body>

    <div class="dashboard">
        <header class="header">
            <h1>Intellisense AI - Ativo de Guerra: Simulador Operacional Nacional</h1>
            <p>Dashboard de Efici√™ncia - A Forja da Persuas√£o Digital (v5.0)</p>
        </header>

        <div class="card cost-calculator" id="cost-calculator-card">
            <h2><i data-feather="dollar-sign"></i> Calculadora do Custo da Inefici√™ncia</h2>
            <p>Taxa de N√£o-Retorno de Clientes Insatisfeitos (Slider - F√°cil de usar com Touch)</p>
            <input type="range" id="non-return-rate" min="1" max="50" value="15" step="1">
            <p>Taxa Estimada de N√£o-Retorno: <span id="rate-display">15</span>%</p>
            <h3>Receita Anual Perdida: <span id="category-loss-text" style="font-size: 0.7em; opacity: 0.7;">Perda total estimada:</span></h3>
            <div id="revenue-lost">R$ 525.000</div>
            <small>*Ticket M√©dio Anual Definido: R$ 3.500.000 (Base de 10.000 h√≥spedes).</small>
        </div>

        <div class="card heatmap" id="heatmap-card">
            <h2><i data-feather="activity"></i> Mapa de Calor de Falhas (Argos Data)</h2>
            <p>An√°lise de 500 avalia√ß√µes negativas - Clique para An√°lise SWOT Profissional</p>
            <div id="heatmap-container">
                <div class="bar" data-category="Check-in" data-severity="85" title="Exemplo: 'Check-in de 1 hora. Inaceit√°vel.'">
                    <span class="bar-label">Check-in</span> <span class="bar-value">(85%)</span>
                </div>
                <div class="bar" data-category="Piscina/√Årea Externa" data-severity="70" title="Exemplo: 'Toalhas sujas e piscina lotada, sem controle.'">
                    <span class="bar-label">Piscina/√Årea Externa</span> <span class="bar-value">(70%)</span>
                </div>
                <div class="bar" data-category="Servi√ßo de Quarto" data-severity="55" title="Exemplo: 'Servi√ßo de quarto demorou 45 minutos para um caf√©.'">
                    <span class="bar-label">Servi√ßo de Quarto</span> <span class="bar-value">(55%)</span>
                </div>
                <div class="bar" data-category="Manuten√ß√£o" data-severity="40" title="Exemplo: 'Ar-condicionado quebrado, tive que ligar 3 vezes.'">
                    <span class="bar-label">Manuten√ß√£o</span> <span class="bar-value">(40%)</span>
                </div>
                <div class="bar" data-category="A&B" data-severity="20" title="Exemplo: 'Bar na cobertura caro e gar√ßom confuso.'">
                    <span class="bar-label">A&B</span> <span class="bar-value">(20%)</span>
                </div>
            </div>
        </div>

        <div class="card ticket-simulator-wrapper" id="ticket-simulator-card">
            <h2 id="ticket-simulator-title"><i data-feather="tag"></i> Simulador de Tickets Inteligentes</h2>
            <div class="guest-view">
                <h3>Vis√£o do H√≥spede</h3>
                <p>Simulador: App de Reporte R√°pido</p>
                <input type="text" id="problem-input" placeholder="Qual o problema? Ex: 'Ar-condicionado n√£o gela.'">
                <button id="report-button">üö® Reportar Problema</button>
            </div>
            <hr style="border-color: var(--color-card-border); margin: 1.5rem 0;">
            <div class="manager-view">
                <h3>Vis√£o do Gerente</h3>
                <p>Tickets Abertos (Onde o tempo est√° correndo)</p>
                <div id="ticket-list"></div>
            </div>
        </div>
    </div>

    <!-- Modal de An√°lise SWOT (Responsivo) -->
    <div class="swot-modal-overlay" id="swot-modal-overlay">
        <div class="swot-modal" id="swot-modal">
            <div class="swot-header">
                <h2 id="swot-title">An√°lise SWOT Detalhada</h2>
                <button class="close-button" id="close-swot-modal"><i data-feather="x"></i></button>
            </div>
            <div id="swot-content-wrapper">
                <!-- Conte√∫do SWOT e Plano de A√ß√£o injetados via JS -->
            </div>
        </div>
    </div>

    <script>
        feather.replace();

        // Vari√°veis Globais
        let ticketIdCounter = 1;
        const BASE_ANNUAL_REVENUE = 3500000;
        const intervalId = setInterval(updateTimers, 1000);
        let activeCategory = null; 
        
        // =========================================================
        // PRIORIDADE 1: DADOS SWOT ROBUSTOS E QUANTIFICADOS (v5.0)
        // =========================================================
        const SWOTData = {
            "Check-in": {
                severity: 85, impact: 0.35,
                ActionPlan: [
                    "Implementa√ß√£o do M√≥dulo de Pr√©-Check-in Digital, reduzindo o tempo de espera em 90%.",
                    "Treinamento de 'Concierges de Boas-Vindas' (liberados pelo sistema) para elevar o NPS inicial em +10 pontos.",
                    "Integra√ß√£o do M√≥dulo de Upsell na etapa de pr√©-check-in, visando aumentar a receita por h√≥spede em 10%."
                ],
                SWOT: {
                    strengths: [
                        { title: "Localiza√ß√£o Ic√¥nica e Premium", detail: "Situado em frente √† praia de Copacabana, este ativo atrai um p√∫blico de alto poder aquisitivo. M√©trica: 95% de aprova√ß√£o na m√©trica 'Localiza√ß√£o'." },
                        { title: "Marca com Forte Apelo Hist√≥rico", detail: "O legado da marca assegura uma base fiel de clientes. M√©trica: 80% de ocupa√ß√£o recorrente (crescimento de 5% A/A)." },
                    ],
                    weaknesses: [
                        { metric: "Tempo M√©dio de Espera", value: "35 min", impact: "Este tempo de espera √© 70% maior que a m√©dia de hot√©is de luxo concorrentes, causando uma quebra imediata na percep√ß√£o de exclusividade e gerando um pico de reclama√ß√µes antes mesmo do h√≥spede chegar ao quarto." },
                        { metric: "Taxa de Reclama√ß√£o no 1¬∫ Contato", value: "35%", impact: "O alto volume de problemas iniciais exige mais recursos da equipe (40 horas/semana) e desvia o foco de tarefas de valor (ex: concierge)." },
                        { metric: "Falhas de Sistema", value: "12%", impact: "Lentid√£o ou falhas no PMS durante o hor√°rio de pico prolongam a espera em at√© 10 minutos por cliente, impactando negativamente 2 em cada 10 h√≥spedes." }
                    ],
                    opportunities: [
                        { title: "Implementar Pr√©-Check-in via App", detail: "Potencial de redu√ß√£o de 90% no tempo de espera, resultando em um aumento projetado de 15% na pontua√ß√£o de 'Satisfa√ß√£o na Chegada' e liberando 25 horas/semana da equipe da recep√ß√£o para focar em tarefas de maior valor." },
                        { title: "Upsells Personalizados na Chegada", detail: "Usar dados do h√≥spede para oferecer upgrades de quarto ou servi√ßos premium, com uma taxa de convers√£o projetada de 8% e retorno sobre investimento (ROI) de 150% no primeiro ano." },
                    ],
                    threats: [
                        { title: "Perda de Clientes de Primeira Viagem", detail: "Estimativa de perda de 25% dos clientes que tiveram uma m√° impress√£o inicial, representando uma receita anual perdida de R$ 875.000,00." },
                        { title: "Posicionamento da Concorr√™ncia", detail: "Concorrentes (ex: Fairmont, Copacabana Palace) j√° utilizam tecnologia para agilizar o check-in, criando um desn√≠vel inaceit√°vel no mercado de luxo e risco de migra√ß√£o de 10% do p√∫blico-alvo." },
                    ]
                }
            },
            "Piscina/√Årea Externa": {
                severity: 70, impact: 0.25,
                ActionPlan: [
                    "Implementa√ß√£o do M√≥dulo de Ocupa√ß√£o em Tempo Real para controle de acesso.",
                    "Otimiza√ß√£o da equipe de limpeza e servi√ßo por demanda (Argos-Tasking).",
                    "Cria√ß√£o de √°reas VVIP controladas por acesso, gerando uma nova linha de receita de 5% A/A."
                ],
                SWOT: {
                    strengths: [
                        { title: "Design Paisag√≠stico e Vista Deslumbrante", detail: "O principal atrativo visual do hotel, gerando mais de 60% do engajamento em m√≠dias sociais (excluindo o lobby)." },
                        { title: "Amplo Espa√ßo de Lazer", detail: "√Årea de 500m¬≤ capaz de acomodar confortavelmente 150 pessoas, oferecendo espa√ßo para eventos exclusivos." }
                    ],
                    weaknesses: [
                        { metric: "Taxa de Ocupa√ß√£o Cr√≠tica", value: "70%", impact: "Atingida em 70% dos finais de semana, levando √† percep√ß√£o de superlota√ß√£o e quebra da experi√™ncia de luxo." },
                        { metric: "Tempo de Limpeza/Reposi√ß√£o", value: "Alto", impact: "A demora na reposi√ß√£o de toalhas e limpeza de mesas gera 40% das reclama√ß√µes na √°rea externa ap√≥s as 14h." }
                    ],
                    opportunities: [
                        { title: "Monitoramento de Ocupa√ß√£o em Tempo Real (IA)", detail: "Permite √† gest√£o de acesso prever e mitigar a superlota√ß√£o com 30 minutos de anteced√™ncia, melhorando a experi√™ncia do h√≥spede e a seguran√ßa." },
                        { title: "Revenue Management em Lazer", detail: "Vender 'Day Use Premium' em hor√°rios de baixa ocupa√ß√£o, com potencial de aumentar a receita em R$ 10.000 por semana." }
                    ],
                    threats: [
                        { title: "Perda de Exclusividade e Luxo", detail: "Coment√°rios em m√≠dias sociais sobre 'piscina lotada' desvalorizam a marca, com risco de queda de 20% nas reservas diretas." },
                        { title: "Normas Sanit√°rias Rigorosas", detail: "O risco de multas sanit√°rias ou fechamento parcial por descumprimento de normas √© alto devido √† falha na gest√£o manual de recursos." }
                    ]
                }
            },
            "Servi√ßo de Quarto": { 
                severity: 55, impact: 0.20, 
                ActionPlan: [
                    "Implementa√ß√£o de Pedidos via QR Code/App, eliminando erros de transcri√ß√£o e comunica√ß√£o (18% de redu√ß√£o de erros).",
                    "Sistema de 'Dispatch Inteligente' que roteia o pedido para o funcion√°rio mais pr√≥ximo/dispon√≠vel.",
                    "Upselling automatizado na plataforma de pedido, visando +15% no valor m√©dio do ticket."
                ],
                SWOT: { 
                    strengths: [
                        { title: "Potencial de Alta Margem de Lucro", detail: "O servi√ßo de quarto √© uma fonte de receita controlada, com potencial de margem l√≠quida de 50% se a efici√™ncia for otimizada." },
                        { title: "Conveni√™ncia Exclusiva para o H√≥spede", detail: "√â um ponto de contato direto e de conveni√™ncia, essencial para a percep√ß√£o de um servi√ßo 5 estrelas." }
                    ], 
                    weaknesses: [
                        { metric: "Tempo M√©dio de Entrega", value: "48 min", impact: "A demora de quase uma hora (pico) resulta em 75% dos pedidos chegando frios ou com qualidade comprometida. Padr√£o de luxo: 20 min." },
                        { metric: "Taxa de Erro no Pedido", value: "18%", impact: "O alto √≠ndice de erros (c√≥d.: 'Pedido Errado') custa ao hotel R$ 5.000/m√™s em custos de refa√ß√£o e vouchers de desculpa." },
                        { metric: "Dificuldade de Contato", value: "15%", impact: "A linha telef√¥nica fica ocupada em 15% das tentativas, for√ßando o h√≥spede a tentar novamente ou desistir (perda de receita)." }
                    ], 
                    opportunities: [
                        { title: "Pedidos via QR Code/App", detail: "A elimina√ß√£o de erros de comunica√ß√£o e gargalos telef√¥nicos pode reduzir o tempo de entrega em 40% e a taxa de erro em 80%." },
                        { title: "Upselling Automatizado (Argos)", detail: "Sugest√µes de harmoniza√ß√£o de bebidas ou acompanhamentos no momento do pedido, com base no perfil do h√≥spede, aumenta o ticket m√©dio em 15%." }
                    ], 
                    threats: [
                        { title: "Concorr√™ncia de Apps de Delivery", detail: "O h√≥spede moderno compara o servi√ßo de quarto com apps de delivery (iFood, Rappi), que s√£o 2x mais r√°pidos e eficientes, levando a uma perda de 30% de potencial receita." },
                        { title: "Reputa√ß√£o por Servi√ßo Lento", detail: "Frustra√ß√£o do h√≥spede gerando avalia√ß√µes negativas que citam 'servi√ßo lento', impactando o ranking em plataformas de viagens." }
                    ] 
                } 
            },
            "Manuten√ß√£o": { 
                severity: 40, impact: 0.15, 
                ActionPlan: [
                    "Sistema de 'Tickets Inteligentes' (com foto) via App para diagn√≥stico imediato e roteamento.",
                    "Ger√™ncia de Acompanhamento em Tempo Real (KPIs de tempo de resposta e resolu√ß√£o) com alertas preditivos.",
                    "Redu√ß√£o do Tempo M√©dio de Resolu√ß√£o (MTTR) em 75% no primeiro trimestre de implementa√ß√£o."
                ], 
                SWOT: { 
                    strengths: [
                        { title: "Equipe Interna Qualificada", detail: "Membros da equipe possuem 8+ anos de experi√™ncia na estrutura espec√≠fica do pr√©dio, garantindo conhecimento profundo dos sistemas internos." }
                    ], 
                    weaknesses: [
                        { metric: "Tempo M√©dio de Resolu√ß√£o (MTTR)", value: "3h 15min", impact: "Este tempo √© inaceit√°vel para o padr√£o de luxo (deveria ser < 60min) e exige a mudan√ßa de quarto em 15% dos casos, elevando custos operacionais." },
                        { metric: "Taxa de Reincid√™ncia", value: "22%", impact: "Problemas recorrentes indicam falta de pe√ßas ou diagn√≥stico superficial, elevando os custos de m√£o de obra em 15% e a insatisfa√ß√£o do h√≥spede." }
                    ], 
                    opportunities: [
                        { title: "Diagn√≥stico Imediato via App (Foto)", detail: "Permite que a manuten√ß√£o prepare a ferramenta e pe√ßa antes de ir ao quarto, reduzindo o tempo de resolu√ß√£o em 50% e a falha na primeira visita em 90%." },
                        { title: "Manuten√ß√£o Preditiva (IoT)", detail: "Uso de sensores para monitorar sistemas cr√≠ticos (HVAC, hidr√°ulica) e prever falhas antes que o h√≥spede as note, eliminando 80% das reclama√ß√µes reativas." }
                    ], 
                    threats: [
                        { title: "Destrui√ß√£o da Percep√ß√£o de Luxo", detail: "Problemas de manuten√ß√£o (ar, chuveiro) s√£o citados em 90% das avalia√ß√µes que atribuem 1 estrela, desvalorizando o pre√ßo da di√°ria." },
                        { title: "Risco de Acidentes e Falhas Estruturais", detail: "A falta de um sistema preditivo aumenta o risco de falhas maiores e n√£o planejadas, que podem custar at√© R$ 50.000 em reparos emergenciais." }
                    ] 
                } 
            },
            "A&B": { 
                severity: 20, impact: 0.05, 
                ActionPlan: [
                    "Sistema de Reservas Inteligente integrado ao perfil do h√≥spede para ofertas personalizadas.",
                    "An√°lise de dados de consumo para otimizar o card√°pio e reduzir 10% do desperd√≠cio.",
                    "Lan√ßamento de um Programa de Fidelidade Digital para o bar da cobertura, aumentando a recorr√™ncia de clientes externos."
                ], 
                SWOT: { 
                    strengths: [
                        { title: "Localiza√ß√£o Privilegiada", detail: "Potencial para bares e restaurantes ic√¥nicos com vista para o mar, atraindo n√£o-h√≥spedes e aumentando o faturamento." },
                        { title: "P√∫blico Cativo de Alto Poder Aquisitivo", detail: "H√≥spedes com alta capacidade de consumo no local, desde que o valor percebido esteja alinhado." }
                    ], 
                    weaknesses: [
                        { metric: "Ocupa√ß√£o M√©dia (H√≥spedes)", value: "25%", impact: "Baixo aproveitamento da receita, indicando que 75% dos h√≥spedes preferem jantar fora do hotel." },
                        { metric: "Reclama√ß√µes 'Pre√ßo Injusto'", value: "40%", impact: "O alto √≠ndice de reclama√ß√µes de pre√ßo sugere um desalinhamento entre a expectativa de valor e a entrega de qualidade/servi√ßo." }
                    ], 
                    opportunities: [
                        { title: "An√°lise de Sentimento do Card√°pio", detail: "Analisar men√ß√µes e avalia√ß√µes para otimizar o card√°pio, priorizando pratos com margem alta e satisfa√ß√£o garantida (aumento de 10% no lucro)." },
                        { title: "Programa de Fidelidade Digital", detail: "Transformar visitantes externos em clientes recorrentes, com potencial de aumentar o tr√°fego em 20% fora dos hor√°rios de pico." }
                    ], 
                    threats: [
                        { title: "Vasta Concorr√™ncia Externa", detail: "A Zona Sul do Rio possui in√∫meros restaurantes e bares de alta qualidade, for√ßando o hotel a competir com pre√ßo ou experi√™ncia." },
                        { title: "Baixa Visibilidade Online", detail: "A baixa taxa de reservas via sistemas online (apenas 5%) indica que os restaurantes e bares n√£o est√£o otimizados digitalmente." }
                    ] 
                } 
            },
        };

        // --- Elementos DOM ---
        const rateSlider = document.getElementById('non-return-rate');
        const rateDisplay = document.getElementById('rate-display');
        const revenueLostDisplay = document.getElementById('revenue-lost');
        const categoryLossText = document.getElementById('category-loss-text');
        const reportButton = document.getElementById('report-button');
        const problemInput = document.getElementById('problem-input');
        const ticketList = document.getElementById('ticket-list');
        const heatmapBars = document.querySelectorAll('.bar');
        const swotModalOverlay = document.getElementById('swot-modal-overlay');
        const swotTitle = document.getElementById('swot-title');
        const swotContentWrapper = document.getElementById('swot-content-wrapper');
        const closeSwotModalButton = document.getElementById('close-swot-modal');

        let tickets = [];

        // --- L√≥gica de Custo (Mantida) ---
        function updateRevenueLost() {
            const baseRate = parseInt(rateSlider.value) / 100;
            rateDisplay.textContent = rateSlider.value;
            let totalLoss = BASE_ANNUAL_REVENUE * baseRate;
            let currentLossText = "Perda total estimada:";

            if (activeCategory && SWOTData[activeCategory]) {
                // A perda total (baseada na taxa de n√£o-retorno) √© modulada pelo impacto da categoria
                totalLoss = totalLoss * SWOTData[activeCategory].impact;
                currentLossText = `Perda estimada por falhas em "${activeCategory}":`;
            }
            
            revenueLostDisplay.textContent = 'R$ ' + Math.round(totalLoss).toLocaleString('pt-BR', { minimumFractionDigits: 0 });
            categoryLossText.textContent = currentLossText;
        }

        rateSlider.addEventListener('input', updateRevenueLost);
        
        // --- L√≥gica do Modal SWOT (ATUALIZADA v5.0) ---
        heatmapBars.forEach(bar => {
            // Garante que o clique funcione perfeitamente em telas touch
            bar.addEventListener('click', (event) => {
                event.stopPropagation(); // Evita fechar o modal se o clique for propagado
                const category = bar.dataset.category;
                
                // Se clicar na mesma barra, desativa o filtro/fecha o modal
                if (activeCategory === category && swotModalOverlay.classList.contains('open')) {
                    closeSWOTModal();
                    return;
                }

                activeCategory = category;
                
                heatmapBars.forEach(b => b.classList.add('faded'));
                bar.classList.remove('faded');
                bar.classList.add('active-drilldown');

                updateRevenueLost(); // Recalcula a perda com o filtro
                renderSWOTModal(category);
            });
        });

        closeSwotModalButton.addEventListener('click', closeSWOTModal);
        swotModalOverlay.addEventListener('click', (event) => {
            if (event.target === swotModalOverlay) {
                closeSWOTModal();
            }
        });

        function closeSWOTModal() {
            swotModalOverlay.classList.remove('open');
            heatmapBars.forEach(b => {
                b.classList.remove('active-drilldown', 'faded');
            });
            activeCategory = null;
            updateRevenueLost(); // Volta ao c√°lculo total
        }

        function renderSWOTModal(category) {
            const data = SWOTData[category];
            if (!data) return;

            swotTitle.innerHTML = `<i data-feather="monitor"></i> An√°lise SWOT: ${category}`;

            // Fun√ß√£o de renderiza√ß√£o para For√ßas, Oportunidades e Amea√ßas (T√≠tulo + Detalhe)
            const renderStructuredList = (items) => items.map(item => `
                <li>
                    <strong>${item.title}</strong>
                    <p>${item.detail}</p>
                </li>
            `).join('');

            const strengths = renderStructuredList(data.SWOT.strengths);
            const opportunities = renderStructuredList(data.SWOT.opportunities);
            const threats = renderStructuredList(data.SWOT.threats);
            
            // Renderiza√ß√£o da Tabela de Fraquezas (M√©trica)
            const weaknessesTable = data.SWOT.weaknesses.map(w => 
                `<tr><td>${w.metric}</td><td>${w.value}</td><td>${w.impact}</td></tr>`
            ).join('');
            
            // Renderiza√ß√£o do Plano de A√ß√£o (Quinto Elemento Distinto)
            const actionPlanHtml = data.ActionPlan.map((p, index) => `
                <div class="action-point">
                    <span class="step-number">${index + 1}</span>
                    <p>${p}</p>
                </div>
            `).join('');

            // Estrutura principal do modal
            const html = `
                <div class="swot-grid">
                    <div class="swot-quadrant quadrant-strengths">
                        <h3><i data-feather="thumbs-up"></i> For√ßas (Strengths)</h3>
                        <ul>${strengths}</ul>
                    </div>
                    <div class="swot-quadrant quadrant-weaknesses">
                        <h3><i data-feather="alert-triangle"></i> Fraquezas (Weaknesses)</h3>
                        <table class="metric-table">
                            <thead><tr><th>M√©trica</th><th>Valor</th><th>Detalhe/Impacto</th></tr></thead>
                            <tbody>${weaknessesTable}</tbody>
                        </table>
                    </div>
                    <div class="swot-quadrant quadrant-opportunities">
                        <h3><i data-feather="trending-up"></i> Oportunidades (Opportunities)</h3>
                        <ul>${opportunities}</ul>
                    </div>
                    <div class="swot-quadrant quadrant-threats">
                        <h3><i data-feather="shield"></i> Amea√ßas (Threats)</h3>
                        <ul>${threats}</ul>
                    </div>
                </div>
                <!-- NOVO: PLANO DE A√á√ÉO RECOMENDADO -->
                <div class="action-plan-banner">
                    <h3><i data-feather="terminal"></i> PLANO DE A√á√ÉO RECOMENDADO (Intellisense AI)</h3>
                    <div class="action-plan-content">
                        ${actionPlanHtml}
                    </div>
                </div>
            `;

            swotContentWrapper.innerHTML = html;
            swotModalOverlay.classList.add('open');
            feather.replace(); 
        }

        // --- L√ìGICA DO SIMULADOR DE TICKETS (Mantida) ---
        reportButton.addEventListener('click', () => {
            const problemText = problemInput.value.trim();
            if (problemText === '') return;

            const newTicket = {
                id: `IS-2025${String(ticketIdCounter++).padStart(4, '0')}`,
                problem: problemText,
                status: 'ABERTO',
                startTime: Date.now(),
                elapsedTime: 0
            };

            tickets.unshift(newTicket);
            renderTicket(newTicket);
            problemInput.value = '';
        });

        function renderTicket(ticket) {
            const ticketCard = document.createElement('div');
            ticketCard.className = 'ticket-card';
            ticketCard.dataset.ticketId = ticket.id;
            
            ticketCard.innerHTML = `
                <strong>ID: ${ticket.id}</strong><br>
                Problema: ${ticket.problem}<br>
                Status: <span class="status-open">${ticket.status}</span> | Tempo de Resposta: <span class="timer" data-id="${ticket.id}">00:00</span>
                <button class="action-button" data-id="${ticket.id}">Solu√ß√£o Inteligente (IA)</button>
            `;
            
            // Adiciona o novo ticket no topo da lista
            ticketList.prepend(ticketCard); 
        }

        ticketList.addEventListener('click', (event) => {
            if (event.target.classList.contains('action-button')) {
                const ticketId = event.target.dataset.id;
                const ticket = tickets.find(t => t.id === ticketId);
                const cardElement = document.querySelector(`.ticket-card[data-ticket-id="${ticketId}"]`);
                
                if (ticket && cardElement && ticket.status === 'ABERTO') {
                    const elapsed = Math.floor((Date.now() - ticket.startTime) / 1000);
                    ticket.elapsedTime = elapsed;
                    ticket.status = 'RESOLVIDO (IA)';
                    
                    const timerSpan = cardElement.querySelector('.timer');
                    const statusSpan = cardElement.querySelector('.status-open') || cardElement.querySelector('.status-solved');

                    if (statusSpan) {
                        statusSpan.textContent = ticket.status;
                        statusSpan.className = 'status-solved';
                    }
                    if (timerSpan) {
                        timerSpan.parentElement.style.borderLeftColor = 'var(--color-success)'; 
                    }

                    event.target.remove();
                    
                    const solutionNote = document.createElement('div');
                    solutionNote.className = 'ia-solution';
                    
                    let solutionMsg = "Recomenda√ß√£o de A√ß√£o Imediata (Argos): Enviar equipe para o setor de Check-in para reduzir a fila.";
                    if (ticket.problem.toLowerCase().includes('ar-condicionado') || ticket.problem.toLowerCase().includes('vazamento')) {
                         solutionMsg = "Recomenda√ß√£o de A√ß√£o Imediata (Argos): Enviar Manuten√ß√£o (Tipo: HVAC/Hidr√°ulica) para o quarto. Alarme de falha proativa acionado.";
                    }
                    
                    solutionNote.innerHTML = `<strong>Resposta Argos (T=${String(Math.floor(elapsed)).padStart(2, '0')}s):</strong> ${solutionMsg}`;
                    cardElement.appendChild(solutionNote);
                }
            }
        });


        function updateTimers() {
            const timers = document.querySelectorAll('.timer');
            timers.forEach(timerElement => {
                const ticketId = timerElement.dataset.id;
                const ticket = tickets.find(t => t.id === ticketId);
                if (ticket && ticket.status === 'ABERTO') {
                    const elapsed = Math.floor((Date.now() - ticket.startTime) / 1000);
                    const minutes = String(Math.floor(elapsed / 60)).padStart(2, '0');
                    const seconds = String(elapsed % 60).padStart(2, '0');
                    timerElement.textContent = `${minutes}:${seconds}`;
                    
                    // Alerta visual de atraso (acima de 2 minutos)
                    if (elapsed > 120) {
                        timerElement.style.color = '#ffcc00'; 
                        timerElement.parentElement.style.borderLeftColor = '#ffcc00';
                    }
                }
            });
        }
        
        // --- INICIALIZA√á√ÉO ---
        document.addEventListener('DOMContentLoaded', () => {
            updateRevenueLost(); 
        });
    </script>
</body>
</html>
